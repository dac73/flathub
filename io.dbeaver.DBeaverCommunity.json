{
	"app-id": "io.dbeaver.DBeaverCommunity",
	"runtime": "org.freedesktop.Platform",
	"runtime-version": "18.08",
    "sdk": "org.freedesktop.Sdk",
    "sdk-extensions": [
        "org.freedesktop.Sdk.Extension.openjdk9"
    ],
	"command": "dbeaver",
	"finish-args": [
        "--share=ipc", "--socket=x11",
        "--socket=wayland",
        "--share=network",
        "--socket=pulseaudio",
        "--device=dri",
        "--talk-name=org.freedesktop.Notifications",
	    	"--filesystem=home"
	],
	"modules": [
        {
            "name": "openjdk",
            "buildsystem": "simple",
            "build-commands": [ "/usr/lib/sdk/openjdk9/install.sh" ]
        },
        {
            "name": "dbeaver-client",
            "buildsystem": "simple",
            "build-commands": [
                "tar -xf dbeaver.tar.gz  --one-top-level=dbeaver_unpack",
                "rm -rf dbeaver.tar.gz",
                "cp -r dbeaver_unpack/dbeaver /app",
                "install -Dt /app/bin dbeaver",                
                "install -Dm644 io.dbeaver.DBeaverCommunity.desktop /app/share/applications/io.dbeaver.DBeaverCommunity.desktop",
                "for icon_size in 32 48 64 128; do install -d /app/share/icons/hicolor/${icon_size}x${icon_size}/apps; install -m644 io.dbeaver.DBeaverCommunity-${icon_size}.png /app/share/icons/hicolor/${icon_size}x${icon_size}/apps/io.dbeaver.DBeaverCommunity.png; done"
            ],
            "sources": [
                {
                    "type": "script",
                    "commands": [
                        "exec env PATH=\"$PATH:/app/jre/bin\" /app/dbeaver/dbeaver \"$@\""
                    ],
                    "dest-filename": "dbeaver"
                },
                {
                    "type": "file",
                    "path": "io.dbeaver.DBeaverCommunity.desktop"
                },
                {
                    "type": "file",
                    "path": "io.dbeaver.DBeaverCommunity-32.png"
                },
                {
                    "type": "file",
                    "path": "io.dbeaver.DBeaverCommunity-48.png"
                },
                {
                    "type": "file",
                    "path": "io.dbeaver.DBeaverCommunity-64.png"
                },
                {
                    "type": "file",
                    "path": "io.dbeaver.DBeaverCommunity-128.png"
                },
                {
                    "type": "file",
                    "dest-filename": "dbeaver.tar.gz",
                    "only-arches": [ "x86_64" ],
                    "url": "https://github.com/dbeaver/dbeaver/releases/download/5.2.3/dbeaver-ce-5.2.3-linux.gtk.x86_64.tar.gz",
                    "sha256": "44143d0861480e186fa6a82ebfb971b24b1b7c87d530148720f7ead280d6c108"
                }
            ]
        }        
    ]
}
